<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>模型实践 on 心有所向，日复一日，必有精进</title>
    <link>http://localhost:1313/categories/%E6%A8%A1%E5%9E%8B%E5%AE%9E%E8%B7%B5/</link>
    <description>Recent content from 心有所向，日复一日，必有精进</description>
    <generator>Hugo</generator>
    <language>zh-cn</language>
    
    <managingEditor>xxx@example.com (落-luo)</managingEditor>
    <webMaster>xxx@example.com (落-luo)</webMaster>
    
    <copyright>本博客所有文章除特别声明外，均采用 BY-NC-SA 许可协议。转载请注明出处！</copyright>
    
    <lastBuildDate>Thu, 13 Nov 2025 15:00:00 +0800</lastBuildDate>
    
    
    <atom:link href="http://localhost:1313/categories/%E6%A8%A1%E5%9E%8B%E5%AE%9E%E8%B7%B5/index.xml" rel="self" type="application/rss&#43;xml" />
    

    
    

    <item>
      <title>GoogleNet模型实践——水果分类</title>
      <link>http://localhost:1313/post/no.20/</link>
      <pubDate>Thu, 13 Nov 2025 15:00:00 &#43;0800</pubDate>
      <author>xxx@example.com (落-luo)</author>
      <guid>http://localhost:1313/post/no.20/</guid>
      <description>
        <![CDATA[<h1>GoogleNet模型实践——水果分类</h1><p>作者：落-luo（xxx@example.com）</p>
        
          <h3 id="前言">
<a class="header-anchor" href="#%e5%89%8d%e8%a8%80"></a>
前言
</h3><p>这是GoogLeNet的另外一个模型实践，这次我们来做水果分类。
关于<a href="https://l-luoluo.github.io/post/no.18/">训练代码</a>和<a href="https://l-luoluo.github.io/post/no.19/">测试代码</a>，还有<a href="https://l-luoluo.github.io/post/no.16/">模型代码</a> 请参考之前的文章。
这里就绪详细介绍一下模型的搭建过程，只是简单的介绍一下，需要修改的部分参数</p>
        
        <hr><p>本文2025-11-13首发于<a href='http://localhost:1313/'>心有所向，日复一日，必有精进</a>，最后修改于2025-11-13</p>]]>
      </description>
      
        <category>GoogleNet</category><category>模型实践</category><category>模型搭建</category><category>炮哥带你学</category><category>pytorch与经典卷积神经网络</category>
      
    </item>
    
    

    <item>
      <title>GoogleNet模型实践——猫狗分类.3</title>
      <link>http://localhost:1313/post/no.19/</link>
      <pubDate>Wed, 12 Nov 2025 15:00:00 &#43;0800</pubDate>
      <author>xxx@example.com (落-luo)</author>
      <guid>http://localhost:1313/post/no.19/</guid>
      <description>
        <![CDATA[<h1>GoogleNet模型实践——猫狗分类.3</h1><p>作者：落-luo（xxx@example.com）</p>
        
          <h3 id="前言">
<a class="header-anchor" href="#%e5%89%8d%e8%a8%80"></a>
前言
</h3><p>在之前的两篇文章中，我们分别介绍了GoogleNet数据集的准备和GoogleNet模型的搭建。
这篇文章主要是测试代码的搭建</p>
<h3 id="测试代码">
<a class="header-anchor" href="#%e6%b5%8b%e8%af%95%e4%bb%a3%e7%a0%81"></a>
测试代码
</h3><h4 id="1-导入必要的库">
<a class="header-anchor" href="#1-%e5%af%bc%e5%85%a5%e5%bf%85%e8%a6%81%e7%9a%84%e5%ba%93"></a>
1. 导入必要的库
</h4><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">torch</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">torch.utils.data</span> <span class="k">as</span> <span class="nn">Data</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">torchvision</span> <span class="kn">import</span> <span class="n">transforms</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">torchvision.datasets</span> <span class="kn">import</span> <span class="n">ImageFolder</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">model</span> <span class="kn">import</span> <span class="n">GoogLeNet</span><span class="p">,</span><span class="n">Inception</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">PIL</span> <span class="kn">import</span> <span class="n">Image</span>
</span></span></code></pre></div><h4 id="2数据集的预处理">
<a class="header-anchor" href="#2%e6%95%b0%e6%8d%ae%e9%9b%86%e7%9a%84%e9%a2%84%e5%a4%84%e7%90%86"></a>
2.数据集的预处理
</h4><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 定义数据预处理</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">test_data_process</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># 定义数据集路径</span>
</span></span><span class="line"><span class="cl">    <span class="n">ROOT_TRAIN</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;data\test&#39;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">normalize</span> <span class="o">=</span> <span class="n">transforms</span><span class="o">.</span><span class="n">Normalize</span><span class="p">(</span><span class="n">mean</span><span class="o">=</span><span class="p">[</span><span class="mf">0.162</span><span class="p">,</span> <span class="mf">0.151</span><span class="p">,</span> <span class="mf">0.138</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">                                     <span class="n">std</span><span class="o">=</span><span class="p">[</span><span class="mf">0.058</span><span class="p">,</span> <span class="mf">0.052</span><span class="p">,</span> <span class="mf">0.047</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># 定义数据集处理方法变量</span>
</span></span><span class="line"><span class="cl">    <span class="n">test_transform</span> <span class="o">=</span> <span class="n">transforms</span><span class="o">.</span><span class="n">Compose</span><span class="p">([</span><span class="n">transforms</span><span class="o">.</span><span class="n">Resize</span><span class="p">((</span><span class="mi">224</span><span class="p">,</span> <span class="mi">224</span><span class="p">)),</span> <span class="n">transforms</span><span class="o">.</span><span class="n">ToTensor</span><span class="p">(),</span> <span class="n">normalize</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># 加载数据集</span>
</span></span><span class="line"><span class="cl">    <span class="n">test_data</span> <span class="o">=</span> <span class="n">ImageFolder</span><span class="p">(</span><span class="n">root</span><span class="o">=</span><span class="n">ROOT_TRAIN</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">test_transform</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">test_dataloader</span> <span class="o">=</span> <span class="n">Data</span><span class="o">.</span><span class="n">DataLoader</span><span class="p">(</span><span class="n">dataset</span><span class="o">=</span><span class="n">test_data</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                                       <span class="n">batch_size</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                                       <span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                                       <span class="n">num_workers</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">test_dataloader</span>
</span></span></code></pre></div><h4 id="3-模型的测试代码">
<a class="header-anchor" href="#3-%e6%a8%a1%e5%9e%8b%e7%9a%84%e6%b5%8b%e8%af%95%e4%bb%a3%e7%a0%81"></a>
3. 模型的测试代码
</h4><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">test_model_process</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">test_dataloader</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># 设定测试所用到的设备，有GPU用GPU没有GPU用CPU</span>
</span></span><span class="line"><span class="cl">    <span class="n">device</span> <span class="o">=</span> <span class="s2">&#34;cuda&#34;</span> <span class="k">if</span> <span class="n">torch</span><span class="o">.</span><span class="n">cuda</span><span class="o">.</span><span class="n">is_available</span><span class="p">()</span> <span class="k">else</span> <span class="s1">&#39;cpu&#39;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># 讲模型放入到训练设备中</span>
</span></span><span class="line"><span class="cl">    <span class="n">model</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># 初始化参数</span>
</span></span><span class="line"><span class="cl">    <span class="n">test_corrects</span> <span class="o">=</span> <span class="mf">0.0</span>
</span></span><span class="line"><span class="cl">    <span class="n">test_num</span> <span class="o">=</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># 只进行前向传播计算，不计算梯度，从而节省内存，加快运行速度</span>
</span></span><span class="line"><span class="cl">    <span class="k">with</span> <span class="n">torch</span><span class="o">.</span><span class="n">no_grad</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">        <span class="k">for</span> <span class="n">test_data_x</span><span class="p">,</span> <span class="n">test_data_y</span> <span class="ow">in</span> <span class="n">test_dataloader</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="c1"># 将特征放入到测试设备中</span>
</span></span><span class="line"><span class="cl">            <span class="n">test_data_x</span> <span class="o">=</span> <span class="n">test_data_x</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="c1"># 将标签放入到测试设备中</span>
</span></span><span class="line"><span class="cl">            <span class="n">test_data_y</span> <span class="o">=</span> <span class="n">test_data_y</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="c1"># 设置模型为评估模式</span>
</span></span><span class="line"><span class="cl">            <span class="n">model</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">            <span class="c1"># 前向传播过程，输入为测试数据集，输出为对每个样本的预测值</span>
</span></span><span class="line"><span class="cl">            <span class="n">output</span><span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">test_data_x</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="c1"># 查找每一行中最大值对应的行标</span>
</span></span><span class="line"><span class="cl">            <span class="n">pre_lab</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">output</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="c1"># 如果预测正确，则准确度test_corrects加1</span>
</span></span><span class="line"><span class="cl">            <span class="n">test_corrects</span> <span class="o">+=</span> <span class="n">torch</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">pre_lab</span> <span class="o">==</span> <span class="n">test_data_y</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="c1"># 将所有的测试样本进行累加</span>
</span></span><span class="line"><span class="cl">            <span class="n">test_num</span> <span class="o">+=</span> <span class="n">test_data_x</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># 计算测试准确率</span>
</span></span><span class="line"><span class="cl">    <span class="n">test_acc</span> <span class="o">=</span> <span class="n">test_corrects</span><span class="o">.</span><span class="n">double</span><span class="p">()</span><span class="o">.</span><span class="n">item</span><span class="p">()</span> <span class="o">/</span> <span class="n">test_num</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;测试的准确率为：&#34;</span><span class="p">,</span> <span class="n">test_acc</span><span class="p">)</span>
</span></span></code></pre></div><h4 id="4-测试代码运行">
<a class="header-anchor" href="#4-%e6%b5%8b%e8%af%95%e4%bb%a3%e7%a0%81%e8%bf%90%e8%a1%8c"></a>
4. 测试代码运行
</h4><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&#34;__main__&#34;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># 加载模型</span>
</span></span><span class="line"><span class="cl">    <span class="n">model</span> <span class="o">=</span> <span class="n">GoogLeNet</span><span class="p">(</span><span class="n">Inception</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">model</span><span class="o">.</span><span class="n">load_state_dict</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;best_model.pth&#39;</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># # 利用现有的模型进行模型的测试</span>
</span></span><span class="line"><span class="cl">    <span class="n">test_dataloader</span> <span class="o">=</span> <span class="n">test_data_process</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="n">test_model_process</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">test_dataloader</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># 设定测试所用到的设备，有GPU用GPU没有GPU用CPU</span>
</span></span><span class="line"><span class="cl">    <span class="n">device</span> <span class="o">=</span> <span class="s2">&#34;cuda&#34;</span> <span class="k">if</span> <span class="n">torch</span><span class="o">.</span><span class="n">cuda</span><span class="o">.</span><span class="n">is_available</span><span class="p">()</span> <span class="k">else</span> <span class="s1">&#39;cpu&#39;</span>
</span></span><span class="line"><span class="cl">    <span class="n">model</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">classes</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;猫&#39;</span><span class="p">,</span> <span class="s1">&#39;狗&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># with torch.no_grad():</span>
</span></span><span class="line"><span class="cl">    <span class="c1">#     for b_x, b_y in test_dataloader:</span>
</span></span><span class="line"><span class="cl">    <span class="c1">#         b_x = b_x.to(device)</span>
</span></span><span class="line"><span class="cl">    <span class="c1">#         b_y = b_y.to(device)</span>
</span></span><span class="line"><span class="cl">    <span class="c1">#</span>
</span></span><span class="line"><span class="cl">    <span class="c1">#         # 设置模型为验证模型</span>
</span></span><span class="line"><span class="cl">    <span class="c1">#         model.eval()</span>
</span></span><span class="line"><span class="cl">    <span class="c1">#         output = model(b_x)</span>
</span></span><span class="line"><span class="cl">    <span class="c1">#         pre_lab = torch.argmax(output, dim=1)</span>
</span></span><span class="line"><span class="cl">    <span class="c1">#         result = pre_lab.item()</span>
</span></span><span class="line"><span class="cl">    <span class="c1">#         label = b_y.item()</span>
</span></span><span class="line"><span class="cl">    <span class="c1">#         print(&#34;预测值：&#34;,  classes[result], &#34;------&#34;, &#34;真实值：&#34;, classes[label])</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">image</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">&#39;w700d1q75cms.jpg&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">normalize</span> <span class="o">=</span> <span class="n">transforms</span><span class="o">.</span><span class="n">Normalize</span><span class="p">([</span><span class="mf">0.162</span><span class="p">,</span> <span class="mf">0.151</span><span class="p">,</span> <span class="mf">0.138</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.058</span><span class="p">,</span> <span class="mf">0.052</span><span class="p">,</span> <span class="mf">0.048</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># 定义数据集处理方法变量</span>
</span></span><span class="line"><span class="cl">    <span class="n">test_transform</span> <span class="o">=</span> <span class="n">transforms</span><span class="o">.</span><span class="n">Compose</span><span class="p">([</span><span class="n">transforms</span><span class="o">.</span><span class="n">Resize</span><span class="p">((</span><span class="mi">224</span><span class="p">,</span> <span class="mi">224</span><span class="p">)),</span> <span class="n">transforms</span><span class="o">.</span><span class="n">ToTensor</span><span class="p">(),</span> <span class="n">normalize</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">    <span class="n">image</span> <span class="o">=</span> <span class="n">test_transform</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># 添加批次维度</span>
</span></span><span class="line"><span class="cl">    <span class="n">image</span> <span class="o">=</span> <span class="n">image</span><span class="o">.</span><span class="n">unsqueeze</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">with</span> <span class="n">torch</span><span class="o">.</span><span class="n">no_grad</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">        <span class="n">model</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">        <span class="n">image</span> <span class="o">=</span> <span class="n">image</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">output</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">pre_lab</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">output</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">result</span> <span class="o">=</span> <span class="n">pre_lab</span><span class="o">.</span><span class="n">item</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;预测值：&#34;</span><span class="p">,</span> <span class="n">classes</span><span class="p">[</span><span class="n">result</span><span class="p">])</span>
</span></span></code></pre></div><p><strong>其中image主要为输入的图片，我们可以根据自己的需求进行修改。</strong>
<strong>将其替换为自己的图片即可。但要放在文件的同一目录下。</strong>
<strong>这里用的是相对路径，不放在一起会报错。</strong>
<strong>当然也可以用绝对路径，这样就不会报错了。</strong></p>
        
        <hr><p>本文2025-11-12首发于<a href='http://localhost:1313/'>心有所向，日复一日，必有精进</a>，最后修改于2025-11-12</p>]]>
      </description>
      
        <category>GoogleNet</category><category>模型实践</category><category>模型搭建</category><category>炮哥带你学</category><category>pytorch与经典卷积神经网络</category>
      
    </item>
    
    

    <item>
      <title>GoogleNet模型实践——猫狗分类.2</title>
      <link>http://localhost:1313/post/no.18/</link>
      <pubDate>Wed, 12 Nov 2025 15:00:00 &#43;0800</pubDate>
      <author>xxx@example.com (落-luo)</author>
      <guid>http://localhost:1313/post/no.18/</guid>
      <description>
        <![CDATA[<h1>GoogleNet模型实践——猫狗分类.2</h1><p>作者：落-luo（xxx@example.com）</p>
        
          <h3 id="前言">
<a class="header-anchor" href="#%e5%89%8d%e8%a8%80"></a>
前言
</h3><p>这篇文章主要是关于猫狗分类的详细的训练代码,关于模型的代码可以参考<a href="https://l-luoluo.github.io/post/no.16/">GoogleNet模型搭建</a>，其中有详细的代码</p>
<h3 id="训练代码">
<a class="header-anchor" href="#%e8%ae%ad%e7%bb%83%e4%bb%a3%e7%a0%81"></a>
训练代码
</h3><h4 id="1-导入必要的库">
<a class="header-anchor" href="#1-%e5%af%bc%e5%85%a5%e5%bf%85%e8%a6%81%e7%9a%84%e5%ba%93"></a>
1. 导入必要的库
</h4><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">copy</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">time</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">torch</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">torchvision.datasets</span> <span class="kn">import</span> <span class="n">ImageFolder</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">torchvision</span> <span class="kn">import</span> <span class="n">transforms</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">torch.utils.data</span> <span class="k">as</span> <span class="nn">Data</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">model</span> <span class="kn">import</span> <span class="n">GoogLeNet</span><span class="p">,</span><span class="n">Inception</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">torch.nn</span> <span class="k">as</span> <span class="nn">nn</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
</span></span></code></pre></div><h4 id="2-数据预处理">
<a class="header-anchor" href="#2-%e6%95%b0%e6%8d%ae%e9%a2%84%e5%a4%84%e7%90%86"></a>
2. 数据预处理
</h4><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># 定义数据集路径</span>
</span></span><span class="line"><span class="cl">    <span class="n">ROOT_TRAIN</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;data\train&#39;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">normalize</span> <span class="o">=</span> <span class="n">transforms</span><span class="o">.</span><span class="n">Normalize</span><span class="p">(</span><span class="n">mean</span><span class="o">=</span><span class="p">[</span><span class="mf">0.162</span><span class="p">,</span> <span class="mf">0.151</span><span class="p">,</span> <span class="mf">0.138</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">                                     <span class="n">std</span><span class="o">=</span><span class="p">[</span><span class="mf">0.058</span><span class="p">,</span> <span class="mf">0.052</span><span class="p">,</span> <span class="mf">0.047</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># 定义数据集处理方法变量</span>
</span></span><span class="line"><span class="cl">    <span class="n">train_transform</span> <span class="o">=</span> <span class="n">transforms</span><span class="o">.</span><span class="n">Compose</span><span class="p">([</span><span class="n">transforms</span><span class="o">.</span><span class="n">Resize</span><span class="p">((</span><span class="mi">224</span><span class="p">,</span><span class="mi">224</span><span class="p">)),</span> <span class="n">transforms</span><span class="o">.</span><span class="n">ToTensor</span><span class="p">(),</span><span class="n">normalize</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># 加载数据集</span>
</span></span><span class="line"><span class="cl">    <span class="n">train_data</span> <span class="o">=</span> <span class="n">ImageFolder</span><span class="p">(</span><span class="n">root</span><span class="o">=</span><span class="n">ROOT_TRAIN</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">train_transform</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">train_data</span><span class="p">,</span> <span class="n">val_data</span> <span class="o">=</span> <span class="n">Data</span><span class="o">.</span><span class="n">random_split</span><span class="p">(</span><span class="n">train_data</span><span class="p">,</span> <span class="p">[</span><span class="nb">round</span><span class="p">(</span><span class="mf">0.8</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">train_data</span><span class="p">)),</span> <span class="nb">round</span><span class="p">(</span><span class="mf">0.2</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">train_data</span><span class="p">))])</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">train_dataloader</span> <span class="o">=</span> <span class="n">Data</span><span class="o">.</span><span class="n">DataLoader</span><span class="p">(</span><span class="n">dataset</span><span class="o">=</span><span class="n">train_data</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                                       <span class="n">batch_size</span><span class="o">=</span><span class="mi">64</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                                       <span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                                       <span class="n">num_workers</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">val_dataloader</span> <span class="o">=</span> <span class="n">Data</span><span class="o">.</span><span class="n">DataLoader</span><span class="p">(</span><span class="n">dataset</span><span class="o">=</span><span class="n">val_data</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                                       <span class="n">batch_size</span><span class="o">=</span><span class="mi">64</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                                       <span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                                       <span class="n">num_workers</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">train_dataloader</span><span class="p">,</span> <span class="n">val_dataloader</span>
</span></span></code></pre></div><p>这里与前面的文章不同的是，我们将数据集的来源由FashionMNIST改为了我们自己的数据集。
并对数据集进行了预处理，其他部分与前面的文章相同。</p>
        
        <hr><p>本文2025-11-12首发于<a href='http://localhost:1313/'>心有所向，日复一日，必有精进</a>，最后修改于2025-11-12</p>]]>
      </description>
      
        <category>GoogleNet</category><category>模型实践</category><category>模型搭建</category><category>炮哥带你学</category><category>pytorch与经典卷积神经网络</category>
      
    </item>
    
    

    <item>
      <title>GoogleNet模型实践——猫狗分类.1</title>
      <link>http://localhost:1313/post/no.17/</link>
      <pubDate>Wed, 12 Nov 2025 15:00:00 &#43;0800</pubDate>
      <author>xxx@example.com (落-luo)</author>
      <guid>http://localhost:1313/post/no.17/</guid>
      <description>
        <![CDATA[<h1>GoogleNet模型实践——猫狗分类.1</h1><p>作者：落-luo（xxx@example.com）</p>
        
          <h3 id="前言">
<a class="header-anchor" href="#%e5%89%8d%e8%a8%80"></a>
前言
</h3><p>这篇文章主要介绍如何使用GoogleNet模型对自己的数据集进行猫狗分类前期准备工作，
详细的训练代码在下一篇文章中介绍</p>
<h3 id="数据集准备">
<a class="header-anchor" href="#%e6%95%b0%e6%8d%ae%e9%9b%86%e5%87%86%e5%a4%87"></a>
数据集准备
</h3><h4 id="划分数据集">
<a class="header-anchor" href="#%e5%88%92%e5%88%86%e6%95%b0%e6%8d%ae%e9%9b%86"></a>
划分数据集
</h4><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">os</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">shutil</span> <span class="kn">import</span> <span class="n">copy</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">random</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">mkfile</span><span class="p">(</span><span class="n">file</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">file</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 获取data文件夹下所有文件夹名（即需要分类的类名）</span>
</span></span><span class="line"><span class="cl"><span class="n">file_path</span> <span class="o">=</span> <span class="s1">&#39;data_cat_dog&#39;</span>
</span></span><span class="line"><span class="cl"><span class="n">flower_class</span> <span class="o">=</span> <span class="p">[</span><span class="n">cla</span> <span class="k">for</span> <span class="n">cla</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">file_path</span><span class="p">)]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 创建 训练集train 文件夹，并由类名在其目录下创建5个子目录</span>
</span></span><span class="line"><span class="cl"><span class="n">mkfile</span><span class="p">(</span><span class="s1">&#39;data/train&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">cla</span> <span class="ow">in</span> <span class="n">flower_class</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">mkfile</span><span class="p">(</span><span class="s1">&#39;data/train/&#39;</span> <span class="o">+</span> <span class="n">cla</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 创建 验证集val 文件夹，并由类名在其目录下创建子目录</span>
</span></span><span class="line"><span class="cl"><span class="n">mkfile</span><span class="p">(</span><span class="s1">&#39;data/test&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">cla</span> <span class="ow">in</span> <span class="n">flower_class</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">mkfile</span><span class="p">(</span><span class="s1">&#39;data/test/&#39;</span> <span class="o">+</span> <span class="n">cla</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 划分比例，训练集 : 测试集 = 9 : 1</span>
</span></span><span class="line"><span class="cl"><span class="n">split_rate</span> <span class="o">=</span> <span class="mf">0.1</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 遍历所有类别的全部图像并按比例分成训练集和验证集</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">cla</span> <span class="ow">in</span> <span class="n">flower_class</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">cla_path</span> <span class="o">=</span> <span class="n">file_path</span> <span class="o">+</span> <span class="s1">&#39;/&#39;</span> <span class="o">+</span> <span class="n">cla</span> <span class="o">+</span> <span class="s1">&#39;/&#39;</span>  <span class="c1"># 某一类别的子目录</span>
</span></span><span class="line"><span class="cl">    <span class="n">images</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">cla_path</span><span class="p">)</span>  <span class="c1"># iamges 列表存储了该目录下所有图像的名称</span>
</span></span><span class="line"><span class="cl">    <span class="n">num</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">images</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">eval_index</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">images</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">num</span> <span class="o">*</span> <span class="n">split_rate</span><span class="p">))</span>  <span class="c1"># 从images列表中随机抽取 k 个图像名称</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">image</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">images</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="c1"># eval_index 中保存验证集val的图像名称</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">image</span> <span class="ow">in</span> <span class="n">eval_index</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">image_path</span> <span class="o">=</span> <span class="n">cla_path</span> <span class="o">+</span> <span class="n">image</span>
</span></span><span class="line"><span class="cl">            <span class="n">new_path</span> <span class="o">=</span> <span class="s1">&#39;data/test/&#39;</span> <span class="o">+</span> <span class="n">cla</span>
</span></span><span class="line"><span class="cl">            <span class="n">copy</span><span class="p">(</span><span class="n">image_path</span><span class="p">,</span> <span class="n">new_path</span><span class="p">)</span>  <span class="c1"># 将选中的图像复制到新路径</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c1"># 其余的图像保存在训练集train中</span>
</span></span><span class="line"><span class="cl">        <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">image_path</span> <span class="o">=</span> <span class="n">cla_path</span> <span class="o">+</span> <span class="n">image</span>
</span></span><span class="line"><span class="cl">            <span class="n">new_path</span> <span class="o">=</span> <span class="s1">&#39;data/train/&#39;</span> <span class="o">+</span> <span class="n">cla</span>
</span></span><span class="line"><span class="cl">            <span class="n">copy</span><span class="p">(</span><span class="n">image_path</span><span class="p">,</span> <span class="n">new_path</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;</span><span class="se">\r</span><span class="s2">[</span><span class="si">{}</span><span class="s2">] processing [</span><span class="si">{}</span><span class="s2">/</span><span class="si">{}</span><span class="s2">]&#34;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">cla</span><span class="p">,</span> <span class="n">index</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">num</span><span class="p">),</span> <span class="n">end</span><span class="o">=</span><span class="s2">&#34;&#34;</span><span class="p">)</span>  <span class="c1"># processing bar</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="s2">&#34;processing done!&#34;</span><span class="p">)</span>
</span></span></code></pre></div><ul>
<li>file_path:用于指定数据集的路径，需要修改为自己的数据集路径</li>
<li>split_rate:用于指定划分数据集的比例，默认值为0.1，即10%的数据用于验证集</li>
<li>data: 用于存放数据的目录</li>
</ul>
<h4 id="数据集的处理">
<a class="header-anchor" href="#%e6%95%b0%e6%8d%ae%e9%9b%86%e7%9a%84%e5%a4%84%e7%90%86"></a>
数据集的处理
</h4><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">PIL</span> <span class="kn">import</span> <span class="n">Image</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">os</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 文件夹路径，包含所有图片文件</span>
</span></span><span class="line"><span class="cl"><span class="n">folder_path</span> <span class="o">=</span> <span class="s1">&#39;data_cat_dog&#39;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 初始化累积变量</span>
</span></span><span class="line"><span class="cl"><span class="n">total_pixels</span> <span class="o">=</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl"><span class="n">sum_normalized_pixel_values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>  <span class="c1"># 如果是RGB图像，需要三个通道的均值和方差</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 遍历文件夹中的图片文件</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">root</span><span class="p">,</span> <span class="n">dirs</span><span class="p">,</span> <span class="n">files</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">walk</span><span class="p">(</span><span class="n">folder_path</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">   <span class="k">for</span> <span class="n">filename</span> <span class="ow">in</span> <span class="n">files</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">       <span class="k">if</span> <span class="n">filename</span><span class="o">.</span><span class="n">endswith</span><span class="p">((</span><span class="s1">&#39;.jpg&#39;</span><span class="p">,</span> <span class="s1">&#39;.jpeg&#39;</span><span class="p">,</span> <span class="s1">&#39;.png&#39;</span><span class="p">,</span> <span class="s1">&#39;.bmp&#39;</span><span class="p">)):</span>  <span class="c1"># 可根据实际情况添加其他格式</span>
</span></span><span class="line"><span class="cl">           <span class="n">image_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">filename</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">           <span class="n">image</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">image_path</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">           <span class="n">image_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">           <span class="c1"># 归一化像素值到0-1之间</span>
</span></span><span class="line"><span class="cl">           <span class="n">normalized_image_array</span> <span class="o">=</span> <span class="n">image_array</span> <span class="o">/</span> <span class="mf">255.0</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">           <span class="c1"># print(image_path)</span>
</span></span><span class="line"><span class="cl">           <span class="c1"># print(normalized_image_array.shape)</span>
</span></span><span class="line"><span class="cl">           <span class="c1"># 累积归一化后的像素值和像素数量</span>
</span></span><span class="line"><span class="cl">           <span class="n">total_pixels</span> <span class="o">+=</span> <span class="n">normalized_image_array</span><span class="o">.</span><span class="n">size</span>
</span></span><span class="line"><span class="cl">           <span class="n">sum_normalized_pixel_values</span> <span class="o">+=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">normalized_image_array</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 计算均值和方差</span>
</span></span><span class="line"><span class="cl"><span class="n">mean</span> <span class="o">=</span> <span class="n">sum_normalized_pixel_values</span> <span class="o">/</span> <span class="n">total_pixels</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">sum_squared_diff</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">root</span><span class="p">,</span> <span class="n">dirs</span><span class="p">,</span> <span class="n">files</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">walk</span><span class="p">(</span><span class="n">folder_path</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">   <span class="k">for</span> <span class="n">filename</span> <span class="ow">in</span> <span class="n">files</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">       <span class="k">if</span> <span class="n">filename</span><span class="o">.</span><span class="n">endswith</span><span class="p">((</span><span class="s1">&#39;.jpg&#39;</span><span class="p">,</span> <span class="s1">&#39;.jpeg&#39;</span><span class="p">,</span> <span class="s1">&#39;.png&#39;</span><span class="p">,</span> <span class="s1">&#39;.bmp&#39;</span><span class="p">)):</span>
</span></span><span class="line"><span class="cl">           <span class="n">image_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">filename</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">           <span class="n">image</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">image_path</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">           <span class="n">image_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">           <span class="c1"># 归一化像素值到0-1之间</span>
</span></span><span class="line"><span class="cl">           <span class="n">normalized_image_array</span> <span class="o">=</span> <span class="n">image_array</span> <span class="o">/</span> <span class="mf">255.0</span>
</span></span><span class="line"><span class="cl">           <span class="c1"># print(normalized_image_array.shape)</span>
</span></span><span class="line"><span class="cl">           <span class="c1"># print(mean.shape)</span>
</span></span><span class="line"><span class="cl">           <span class="c1"># print(image_path)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">           <span class="k">try</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">               <span class="n">diff</span> <span class="o">=</span> <span class="p">(</span><span class="n">normalized_image_array</span> <span class="o">-</span> <span class="n">mean</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span>
</span></span><span class="line"><span class="cl">               <span class="n">sum_squared_diff</span> <span class="o">+=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">diff</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">           <span class="k">except</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">               <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;捕获到自定义异常&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">           <span class="c1"># diff = (normalized_image_array - mean) ** 2</span>
</span></span><span class="line"><span class="cl">           <span class="c1"># sum_squared_diff += np.sum(diff, axis=(0, 1))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">variance</span> <span class="o">=</span> <span class="n">sum_squared_diff</span> <span class="o">/</span> <span class="n">total_pixels</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="s2">&#34;Mean:&#34;</span><span class="p">,</span> <span class="n">mean</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="s2">&#34;Variance:&#34;</span><span class="p">,</span> <span class="n">variance</span><span class="p">)</span>
</span></span></code></pre></div><p>这给脚本主题要负责的是数据集的处理，包括归一化和计算均值方差
而这两个值在后续的模型训练中会被用到</p>
        
        <hr><p>本文2025-11-12首发于<a href='http://localhost:1313/'>心有所向，日复一日，必有精进</a>，最后修改于2025-11-12</p>]]>
      </description>
      
        <category>GoogleNet</category><category>模型实践</category><category>模型搭建</category><category>炮哥带你学</category><category>pytorch与经典卷积神经网络</category>
      
    </item>
    
  </channel>
</rss>
